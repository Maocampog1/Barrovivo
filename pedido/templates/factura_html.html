{% load humanize static %}
<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Factura {{ compra.numero }}</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  @media print {
    .no-print { display: none !important; }
    body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  }
  .banda { background:#EF6E3A; color:#fff; padding:6px 12px; border-radius:6px; font-weight:600; display:inline-block; }
  .enc { display:flex; align-items:center; justify-content:space-between; gap:16px; }
  .logo { height:56px; }
  .gris { color:#666; }
  .tabla th { background:#fafafa; }
</style>
</head>
<body class="container py-4">
  <div class="d-flex justify-content-end no-print mb-3">
    <button class="btn btn-primary" onclick="window.print()">
      Imprimir / Guardar como PDF
    </button>
  </div>

  <div class="enc mb-3">
    <img src="{% static 'multimedia/logo.png' %}" class="logo" alt="BARROVIVO">
    <div class="text-center flex-fill">
      <div class="fw-bold fs-5">Factura de Venta</div>
      <div class="gris">BARROVIVO</div>
    </div>
    <div class="text-end">
      <div class="banda">{{ compra.numero }}</div>
      <div class="gris mt-1">{{ compra.creado }}</div>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-md-6">
      <div class="p-3 border rounded-3 h-100">
        <h6 class="mb-2">Información de facturación</h6>
        <div>Cliente: {{ compra.facturacion.nombres }} {{ compra.facturacion.apellidos }}</div>
        <div>Cédula: {{ compra.facturacion.cedula }}</div>
        <div>Celular: {{ compra.facturacion.telefono }}</div>
        <div>Correo: {{ compra.facturacion.correo }}</div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="p-3 border rounded-3 h-100">
        <h6 class="mb-2">Detalles de envío</h6>
        <div>Departamento/Municipio: {{ compra.envio.departamento }} / {{ compra.envio.municipio }}</div>
        <div>Dirección: {{ compra.envio.direccion }} {{ compra.envio.apto_info }}</div>
      </div>
    </div>
  </div>

  <div class="table-responsive mt-4">
    <table class="table tabla align-middle">
      <thead>
        <tr>
          <th>Producto</th>
          <th class="text-end">Cantidad</th>
          <th class="text-end">Valor Neto</th>
          <th class="text-end">Total</th>
        </tr>
      </thead>
      <tbody>
        {% for it in compra.lineas %}
        <tr>
          <td>{{ it.nombre }}</td>
          <td class="text-end">{{ it.cantidad }}</td>
          <td class="text-end">${{ it.precio_unitario|intcomma }}</td>
          <td class="text-end">${{ it.subtotal|intcomma }}</td>
        </tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr>
          <td colspan="3" class="text-end fw-bold">TOTAL:</td>
          <td class="text-end fw-bold">${{ compra.total|intcomma }}</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <p class="text-center text-muted mt-4">Gracias por tu compra — BARROVIVO</p>
</body>
</html>
