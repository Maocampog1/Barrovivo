{% extends "base.html" %}
{% load humanize %}

{% block content %}
<div class="container py-3">

  <!-- Filtros (dropdown) -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="dropdown">
      <button class="btn btn-outline-secondary btn-filtros dropdown-toggle"
             type="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="bi bi-sliders me-1"></i> Filtrar productos
      </button>


      <div class="dropdown-menu p-3" style="min-width: 300px;">
        <form method="get">
          <!-- Categorías -->
          <div class="mb-2 fw-semibold">Filtrar por Categoría</div>
          {% for c in categorias %}
            <div class="form-check mb-1">
              <input class="form-check-input" type="checkbox" name="cat"
                     id="cat_{{ c.id }}" value="{{ c.slug }}"
                     {% if c.slug in cats_seleccionadas %}checked{% endif %}>
              <label class="form-check-label" for="cat_{{ c.id }}">{{ c.nombre }}</label>
            </div>
          {% empty %}
            <div class="text-muted small">No hay categorías.</div>
          {% endfor %}

          <hr class="my-3">

          <!-- Precio -->
          <div class="mb-2 fw-semibold">Filtrar por precio</div>
          <div class="input-group input-group-sm mb-2">
            <span class="input-group-text">$</span>
            <input type="number" class="form-control" name="min"
                   value="{{ precio_min }}" placeholder="Mínimo">
            <span class="input-group-text">-</span>
            <span class="input-group-text">$</span>
            <input type="number" class="form-control" name="max"
                   value="{{ precio_max }}" placeholder="Máximo">
          </div>

          <hr class="my-3">

          <!-- Orden (placeholder) -->
          <div class="mb-2 fw-semibold">Ordenar por</div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="orden" id="o_mas"
                   value="mas" {% if orden == 'mas' %}checked{% endif %}>
            <label class="form-check-label" for="o_mas">Más vendidos (próx.)</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="orden" id="o_menos"
                   value="menos" {% if orden == 'menos' %}checked{% endif %}>
            <label class="form-check-label" for="o_menos">Menos vendidos (próx.)</label>
          </div>

          <!-- Acciones -->
          <div class="d-flex gap-2">
            <button class="btn btn-primary btn-sm" type="submit">Aplicar</button>
            <a href="{% url 'usuario:home' %}" class="btn btn-outline-secondary btn-sm">Limpiar</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <h1 class="h4 mb-3">Catálogo</h1>

  {% include "productos.html" with productos=productos %}

</div>
{% endblock %}
